<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Momondo</title>
  </head>
  <body>
    <button onclick="getFlights()">GET FLIGHTS</button>
    <div>FROM: <span id="from"></span></div>
    <div>Date: <span id="date"></span></div>
    <div id="stops"></div>

    <!-- <div id="flights"></div> -->

    <script>
      async function getFlights() {
        let connection = await fetch("momondo.php");
        let jData = await connection.json();

        let aOrderedArray = [];

        for (let i = 0; i < jData.schedule.length; i++) {
          aOrderedArray[jData.schedule[i].flightOrder] = jData.schedule[i];
        }

        console.log(aOrderedArray);
        let sDivFlight = "";

        for (let i = 0; i < aOrderedArray.length; i++) {
          let sFromDate = new Date(0);
          sFromDate.setUTCSeconds(aOrderedArray[i].date);
          sFromDate = sFromDate.toLocaleString("da-DK");
          sDivFlight += `
            <img class="airline-icon" src="icons/${aOrderedArray[i].airlineIcon}" alt="" />
            <div>FROM: ${aOrderedArray[i].from}</div>
            <div>DATE: ${sFromDate}</div>`;
        }
        document.getElementById("stops").innerHTML = sDivFlight;
        let jLastCity = aOrderedArray[aOrderedArray.length - 1];
        console.log(jLastCity);
        let sTo = `<div>Arrives at city: ${jLastCity.to}</div>`;
        // document.getElementById('stops').innerHTML += sTo
        document.getElementById("stops").insertAdjacentHTML("beforeend", sTo);
      }
    </script>
  </body>
</html>
